# VLESS WebSocket + CDN Tunnel Setup

Automated Bash installer that deploys an Xray VLESS-over-WebSocket endpoint behind Nginx and a CDN-friendly fake website. The script generates TLS certificates, writes an Xray config, and outputs a ready-to-import VLESS URI so you can connect through a CDN-backed domain quickly.

## What you get
- Nginx TLS terminator with optional autogenerated cover website to blend with normal HTTPS traffic.
- Xray VLESS inbound bound to 127.0.0.1 with a customizable WebSocket path.
- Automatic certificate provisioning (prefers Certbot, falls back to acme.sh or a self-signed pair).
- Optional UFW rules that allow SSH, HTTP, and HTTPS.
- Clear post-install summary with domain, path, UUID, and the full VLESS link.

## Prerequisites
- Ubuntu 22.04+ (apt and systemd required).
- A domain pointed at the server‚Äôs public IP (update DNS before running).
- Root access (run with `sudo` or as root).
- Optionally fronted by a CDN (e.g., Cloudflare) once DNS is in place.

## Quick start
1. Clone or download this repository on your VPS.
2. Make the script executable and run it as root:
   ```bash
   chmod +x setup.sh
   sudo ./setup.sh
   ```
3. Answer the prompts:
   - Domain name (required, e.g., `example.com`).
   - Is this a fresh install? (decides if `apt-get upgrade` runs).
   - Auto-generate a fake cover site? (`y` recommended).
   - WebSocket path (default `/ws`, leading slash enforced).
   - Provide your own UUID or let the script generate one.
   - Configure and enable UFW for ports 22/80/443.

The script will install packages, request certificates, configure Xray, and set up Nginx. On a 1 vCPU / 1 GB RAM VPS the full run takes about **2 minutes 41 seconds**.

## What the script outputs
At the end you‚Äôll see a summary similar to:
```
Domain       : your.domain
WebSocket WS : /ws
UUID         : <generated-or-custom-uuid>
VLESS URI    : vless://UUID@DOMAIN:443?encryption=none&security=tls&type=ws&host=DOMAIN&path=%2Fws
Key paths:
  Xray config : /usr/local/etc/xray/config.json (or /etc/xray/config.json fallback)
  Website root: /var/www/html/
  Nginx site  : /etc/nginx/sites-enabled/<domain>
  Cert dir    : /etc/letsencrypt (or acme/self-signed dir)
```
Copy the VLESS URI into your client; the path is URL-encoded. Services (Nginx, Xray, and optionally UFW) are started automatically.

## Using the InvisibleMan XRay client
You can import the generated VLESS URI into the [InvisibleMan XRay client](https://github.com/InvisibleManVPN/InvisibleMan-XRayClient). Set the domain, UUID, and WebSocket path to match the summary above; TLS with CDN hosting works out of the box.

## Demo videos üìπ
- **before.mp4**: live run showing the full automated setup and timing (2m41s on 1vCPU/1GB RAM).
- **after.mp4**: example of connecting and using the deployed endpoint.

You can play the clips directly in this repo (GitHub‚Äôs web UI renders them inline):

<details>
<summary>üëÄ Quick previews</summary>

- Before setup: <video src="before.mp4" controls width="480">before.mp4</video>
- After setup: <video src="after.mp4" controls width="480">after.mp4</video>

</details>

## How it slips past basic DPI üïµÔ∏è
- Traffic rides over HTTPS (TLS) with a normal-looking host and WebSocket path, so shallow packet inspection only sees standard web traffic.
- Optional cover site content on port 443 keeps the TLS SNI/ALPN negotiation indistinguishable from typical CDN-fronted sites.
- CDN fronting (e.g., Cloudflare) terminates TLS and forwards WebSocket frames, hiding the origin and making the flow look like regular proxied HTTPS.

## Troubleshooting tips
- Verify services: `systemctl status xray`, `systemctl status nginx`.
- Check logs: `/var/log/xray/access.log`, `/var/log/xray/error.log`, and Nginx logs in `/var/log/nginx/`.
- Ensure DNS records resolve to the server before running; certificate requests will fail otherwise.
- If Nginx fails to install, the script continues without it, but TLS termination and the fake site will be unavailable.
